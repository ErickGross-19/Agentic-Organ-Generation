{
  "schema": {
    "name": "aog_designspec",
    "version": "1.0.0",
    "compatible_with": ["1.0.x"]
  },
  "meta": {
    "name": "07_fang_hook_channels",
    "description": "Demonstrates fang-hook channel primitives with radial outward bending. Uses constraint strategies (reduce_depth, rotate, both) to enforce effective radius. This showcases curved channel generation with ridge constraints.",
    "seed": 77777,
    "input_units": "mm",
    "tags": ["fang_hook", "channels", "curved", "ridge_constraint", "radial_out"]
  },
  "policies": {
    "resolution": {
      "input_units": "mm",
      "min_channel_diameter": 0.2,
      "min_voxels_across_feature": 4,
      "max_voxels": 2000000,
      "auto_relax_pitch": true,
      "pitch_step_factor": 1.5,
      "embed_pitch_factor": 1.0,
      "max_voxels_embed": 1500000
    },
    "domain_meshing": {
      "cache_meshes": true,
      "emit_warnings": true,
      "target_face_count": 25000
    },
    "growth": {
      "enabled": false
    },
    "collision": {
      "enabled": false
    },
    "ports": {
      "enabled": true,
      "face": "top",
      "pattern": "explicit",
      "projection_mode": "clamp_to_face",
      "ridge_width": 0.2,
      "ridge_clearance": 0.15,
      "port_margin": 0.5,
      "disk_constraint_enabled": true,
      "ridge_constraint_enabled": true,
      "placement_fraction": 0.7,
      "angular_offset": 0.0
    },
    "channels": {
      "enabled": true,
      "profile": "fang_hook",
      "length_mode": "to_depth",
      "length_fraction": 1.0,
      "stop_before_boundary": 0.15,
      "segments_per_curve": 20,
      "radial_sections": 16,
      "path_samples": 40,
      "enforce_effective_radius": true,
      "constraint_strategy": "both",
      "bend_mode": "radial_out",
      "hook_depth": 1.8,
      "hook_strength": 0.6,
      "hook_angle_deg": 50.0,
      "straight_fraction": 0.25,
      "curve_fraction": 0.45,
      "bend_shape": "quadratic"
    },
    "composition": {
      "repair_enabled": true,
      "union_before_embed": true,
      "repair_fill_holes": true,
      "keep_largest_component": true,
      "min_component_volume": 0.001
    },
    "embedding": {
      "voxel_pitch": null,
      "use_resolution_policy": true,
      "auto_adjust_pitch": true,
      "max_voxels": 1500000,
      "fallback": "auto",
      "preserve_ports_enabled": true,
      "preserve_mode": "recarve",
      "carve_radius_factor": 1.2,
      "carve_depth": 2.0,
      "output_domain_with_void": true,
      "output_void_mesh": true,
      "output_shell": false
    },
    "validity": {
      "check_watertight": true,
      "check_components": true,
      "check_min_diameter": false,
      "check_open_ports": true,
      "check_bounds": true,
      "check_void_inside_domain": true,
      "max_components": 1
    },
    "open_port": {
      "enabled": true,
      "probe_radius_factor": 1.2,
      "probe_length": 2.0,
      "min_connected_volume_voxels": 10,
      "mode": "voxel_connectivity",
      "local_region_size": 5.0,
      "max_voxels_roi": 300000,
      "auto_relax_pitch": true
    },
    "repair": {
      "voxel_repair_enabled": true,
      "auto_adjust_pitch": true,
      "max_pitch_steps": 3,
      "pitch_step_factor": 1.5,
      "fill_voxels": true,
      "remove_small_components_enabled": true,
      "min_component_faces": 100,
      "min_component_volume": 0.001,
      "fill_holes_enabled": true,
      "smooth_enabled": false
    },
    "output": {
      "output_dir": "./out/07_fang_hook_channels",
      "output_units": "mm",
      "naming_convention": "default",
      "save_intermediates": true,
      "save_reports": true,
      "output_stl": true,
      "output_json": true
    }
  },
  "domains": {
    "cylinder_domain": {
      "type": "cylinder",
      "center": [0, 0, 0],
      "radius": 6,
      "height": 4
    }
  },
  "components": [
    {
      "id": "fang_center",
      "domain_ref": "cylinder_domain",
      "ports": {
        "inlets": [
          {
            "name": "inlet_center",
            "position": [0, 0, 2],
            "direction": [0, 0, -1],
            "radius": 0.35,
            "vessel_type": "arterial"
          }
        ],
        "outlets": []
      },
      "build": {
        "type": "primitive_channels"
      },
      "save_artifacts": {
        "void_mesh": "artifacts/fang_center_void.stl"
      }
    },
    {
      "id": "fang_ring_a",
      "domain_ref": "cylinder_domain",
      "ports": {
        "inlets": [
          {
            "name": "inlet_ring_a",
            "position": [2.5, 0, 2],
            "direction": [0, 0, -1],
            "radius": 0.3,
            "vessel_type": "arterial"
          }
        ],
        "outlets": []
      },
      "build": {
        "type": "primitive_channels"
      },
      "save_artifacts": {
        "void_mesh": "artifacts/fang_ring_a_void.stl"
      }
    },
    {
      "id": "fang_ring_b",
      "domain_ref": "cylinder_domain",
      "ports": {
        "inlets": [
          {
            "name": "inlet_ring_b",
            "position": [-2.5, 0, 2],
            "direction": [0, 0, -1],
            "radius": 0.3,
            "vessel_type": "arterial"
          }
        ],
        "outlets": []
      },
      "build": {
        "type": "primitive_channels"
      },
      "save_artifacts": {
        "void_mesh": "artifacts/fang_ring_b_void.stl"
      }
    },
    {
      "id": "fang_ring_c",
      "domain_ref": "cylinder_domain",
      "ports": {
        "inlets": [
          {
            "name": "inlet_ring_c",
            "position": [0, 2.5, 2],
            "direction": [0, 0, -1],
            "radius": 0.3,
            "vessel_type": "arterial"
          }
        ],
        "outlets": []
      },
      "build": {
        "type": "primitive_channels"
      },
      "save_artifacts": {
        "void_mesh": "artifacts/fang_ring_c_void.stl"
      }
    },
    {
      "id": "fang_ring_d",
      "domain_ref": "cylinder_domain",
      "ports": {
        "inlets": [
          {
            "name": "inlet_ring_d",
            "position": [0, -2.5, 2],
            "direction": [0, 0, -1],
            "radius": 0.3,
            "vessel_type": "arterial"
          }
        ],
        "outlets": []
      },
      "build": {
        "type": "primitive_channels"
      },
      "save_artifacts": {
        "void_mesh": "artifacts/fang_ring_d_void.stl"
      }
    }
  ],
  "composition": {
    "save_union": "artifacts/union_void.stl"
  },
  "embedding": {
    "enable": true,
    "outputs": {
      "domain_with_void": "domain_with_void.stl",
      "void_mesh": "void_union.stl"
    }
  },
  "validity": {
    "enable": true,
    "save_report": "validity_report.json"
  },
  "outputs": {
    "artifacts_dir": "artifacts",
    "named": {
      "run_report": "run_report.json"
    }
  }
}
